import unittest

from utils import GetConfig
from utils import KalturaBaseTest
from utils import getTestFile

from KalturaClient.Client import KalturaClient

class ClientParseResultTests(KalturaBaseTest):
    
    def test_truncated_UTF8(self):
        """The 'name' element contains an invalid UTF8 character at the end."""
        
        data = """<?xml version="1.0" encoding="utf-8"?>
<xml>
  <result>
    <objectType>KalturaMediaListResponse</objectType>
    <objects>
      <item>
        <objectType>KalturaMediaEntry</objectType>
        <name>\xe1\x9e\x9b\xe1\x9e\x91\xe1\x9f\x92\xe1\x9e\x92\xe1\x9e\x95\xe1\x9e\x9b\xe1\x9e\x9a\xe1\x9e\x94\xe1\x9e\xb6\xe1\x9e\x99\xe1\x9e\x80\xe1\x9e\xb6\xe1\x9e\x9a\xe1\x9e\x8e\xe1\x9f\x8d\xe1\x9e\x96\xe1\x9e\xb8\xe1\x9e\x9f\xe1\x9f\x92\xe1\x9e\x90\xe1\x9e\xb6\xe1\x9e\x93\xe1\x9e\x97\xe1\x9e\xb6\xe1\x9e\x96\xe1\x9e\x9f\xe1\x9e\xb7\xe1\x9e\x91\xe1\x9f\x92\xe1\x9e\x92\xe1\x9e\xb7\xe1\x9e\x98\xe1\x9e\x93\xe1\x9e\xbb\xe1\x9e\x9f\xe1\x9f\x92\xe1\x9e\x9f\xe1\x9e\x80\xe1\x9e\x98\xe1\x9f\x92\xe1\x9e\x96\xe1\x9e\xbb\xe1\x9e\x87\xe1\x9e\xb6\xe1\x9e\x80\xe1\x9f\x92\xe1\x9e\x93\xe1\x9e\xbb\xe1\x9e\x84\xe1\x9e\x9f\xe1\x9e\x93\xe1\x9f\x92\xe1\x9e\x93\xe1\x9e\xb7\xe1\x9e\x9f\xe1\x9e\xb8\xe1\x9e\x91\xe1\x9e\x93\xe1\x9f\x83\xe1\x9e\xa2\xe1\x9e\x84\xe1\x9f\x92\xe1\x9e\x82\xe1\x9e\x80\xe1\x9e\xb6\xe1\x9e\x9a\xe1\x9e\x9f\xe1\x9e\xa0\xe1\x9e\x94\xe1\x9f\x92\xe1\x9e\x9a\xe1\x9e\x87\xe1\x9e\xb6\xe1\x9e\x87\xe1\x9e\xb6\xe1\x9e\x8f\xe1\x9e\xb7 (\xe1\x9e\x9c\xe1\x9e\x82\xe1\x9f\x92\xe1\x9e\x82 \xe1\x9e\x94\xe1\x9e\x89\xe1\x9f\x92\xe1</name>
      </item>
    </objects>
    <totalCount>1</totalCount>
  </result>
  <executionTime>0.16186594963074</executionTime>
</xml>
        """
        
        dummyClient = KalturaClient(config=DummyConfig())
        
        dummyClient.parsePostResult(data)
        
        
class DummyConfig(object):
    
    def getLogger(self):
        return None
    
        
def test_suite():
    return unittest.TestSuite((
        unittest.makeSuite(ClientParseResultTests),
        ))

if __name__ == "__main__":
    suite = test_suite()
    unittest.TextTestRunner(verbosity=2).run(suite)